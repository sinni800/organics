"object"!==typeof JSON&&(JSON={});
(function(){function h(a){return 10>a?"0"+a:a}function a(a){b.lastIndex=0;return b.test(a)?'"'+a.replace(b,function(a){var b=d[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(b,e){var d,p,n,h,q=f,m,g=e[b];g&&("object"===typeof g&&"function"===typeof g.toJSON)&&(g=g.toJSON(b));"function"===typeof l&&(g=l.call(e,b,g));switch(typeof g){case "string":return a(g);case "number":return isFinite(g)?String(g):"null";case "boolean":case "null":return String(g);
case "object":if(!g)return"null";f+=k;m=[];if("[object Array]"===Object.prototype.toString.apply(g)){h=g.length;for(d=0;d<h;d+=1)m[d]=c(d,g)||"null";n=0===m.length?"[]":f?"[\n"+f+m.join(",\n"+f)+"\n"+q+"]":"["+m.join(",")+"]";f=q;return n}if(l&&"object"===typeof l)for(h=l.length,d=0;d<h;d+=1)"string"===typeof l[d]&&(p=l[d],(n=c(p,g))&&m.push(a(p)+(f?": ":":")+n));else for(p in g)Object.prototype.hasOwnProperty.call(g,p)&&(n=c(p,g))&&m.push(a(p)+(f?": ":":")+n);n=0===m.length?"{}":f?"{\n"+f+m.join(",\n"+
f)+"\n"+q+"}":"{"+m.join(",")+"}";f=q;return n}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,k,d={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,d){var e;k=f="";if("number"===typeof d)for(e=0;e<d;e+=1)k+=" ";else"string"===typeof d&&(k=d);if((l=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function c(a,d){var e,f,g=a[d];if(g&&"object"===typeof g)for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&(f=c(g,e),void 0!==f?g[e]=f:delete g[e]);return b.call(a,d,g)}var d;a=String(a);e.lastIndex=0;e.test(a)&&(a=a.replace(e,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return d=eval("("+a+")"),"function"===typeof b?c({"":d},""):d;throw new SyntaxError("JSON.parse");})})();
var Organics=new function(){this.Debug=!1;this.WebSocketSupported="WebSocket"in window||"MozWebSocket"in window;this.Connect="A!B@C#D$E%F^G&H*I(J)";this.Disconnect="a1b2c3d4e5f6g7h8i9j0";this.__rtLongPollEstablishConnection="lpec";this.__rtLongPoll="lp";this.__rtMessage="m";this.ErrNotConnected="not currently connected to server";this.__addEventListener=function(a,c,e){document.addEventListener?a.addEventListener(c,e,!1):a.attachEvent("on"+c,e)};this.__isPageBeingRefreshed=!1;this.__addEventListener(window,
"beforeunload",function(){Organics.__isPageBeingRefreshed=!0});this.__Log=function(a){Organics.Debug&&window.console&&console.log("Organics: "+a)};if(this.WebSocketSupported){var h=null,h="WebSocket"in window?window.WebSocket:window.MozWebSocket;2>=h.CLOSED&&(this.WebSocketSupported=!1,window.console&&console.log("Organics: Browser only supports < hybi 07 WebSockets; falling back to long polling."))}this.__StackTrace=function(){return Error("StackTrace").stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,
"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@").split("\n")};this.__LogStackTrace=function(){if(Organics.Debug){for(var a=Organics.__StackTrace(),c=0;c<a.length;c++)window.console&&console.log(a[c]);window.console&&console.log("\n")}};this.__StringStartsWith=function(a,c){return a.slice(0,c.length)==c};this.__StringEndsWith=function(a,c){return a.slice(-c.length)==c};this.__xhr=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.createRequest)return window.createRequest();
if(window.ActiveXObject)for(var a=["Msxml3.XMLHTTP","Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<a.length;c++)try{return new ActiveXObject(a[c])}catch(e){}};this.__translateWindowsError=function(a){switch(a){case 12001:return"Internet handle could not be generated at this time.";case 12002:return"Request timed out.";case 12004:return"An internal internet error has occured.";case 12005:return"URL is invalid.";case 12006:return"URL scheme could not be recognized or is not supported.";
case 12007:return"Server name could not be resolved.";case 12008:return"The requested protocol could not be found.";case 12013:return"Failed to log on to FTP server, user name is incorrect.";case 12014:return"Failed to log on to FTP server, password is incorrect.";case 12015:return"Failed to coonect and log on to FTP server.";case 12023:return"Direct network access cannot be made at this time.";case 12029:return"Unable to connect to server.";case 12030:return"Connection terminated.";case 12031:return"Connection reset.";
case 12037:return"Date on server's SSL certificate is bad expired.";case 12038:return"Host name on server's SSL certificate is incorrect.";case 12040:return"Moving from non-SSL to SSL due to redirect.";case 12042:return"Attempt to post and change data on server that is not secure.";case 12043:return"Attempt to post data on server that is not secure.";case 12110:return"FTP operation failed, operation is already in progress.";case 12111:return"FTP operation failed, the session was aborted.";case 12150:return"Requested HTTP header could not be found.";
case 12151:return"Server returned no HTTP headers.";case 12152:return"Server response could not be parsed.";case 12156:return"HTTP redirect failed, scheme changed or all attempts failed."}};this.__ajax=function(a,c,e,b,f,k){var d=new Organics.__xhr;if(d){var l=null;f&&(l=setTimeout(function(){d.abort();e.error(d,"timed out")},f));d.onreadystatechange=function(){if(4==d.readyState)if(l&&clearTimer(l),200==d.status)e.complete(d);else{var a=Organics.__translateWindowsError(d.status);Organics.__isPageBeingRefreshed&&
0==d.status||(0==d.status?e.error(d,"network error"):null!=a?e.error(d,d.status+" "+a):e.error(d,d.status+" "+d.statusText))}};try{d.open(c,a,!0)}catch(h){e.error(d,"XMLHttpRequest.open failed: "+h);return}null==k&&(k={});null==k["Content-Type"]&&(k["Content-Type"]="text/plain;charset=UTF-8");if(k)for(var r in k)d.setRequestHeader(r,k[r]);try{d.send(b)}catch(t){e.error(d,"XMLHttpRequest.send failed: "+t)}}else e.error(null,"Browser has no support for AJAX")};this.Connection=function(a,c,e){var b=
this;b.__requestCounter=-1;b.__requestHandlers={};b.__URL=a;if("string"!=typeof b.__URL)throw TypeError("URL parameter must be an string!");b.URL=b.__URL;b.TLS=c;null==b.TLS&&(b.TLS=!1);if("boolean"!=typeof b.TLS)throw TypeError("TLS optional parameter must be bool!");b.Timeout=e;null==b.Timeout&&(b.Timeout=15E3);b.Timeout=e;b.__handlers={};b.__connected=!1;b.__connecting=!1;Organics.__StringStartsWith(b.__URL,"/")&&(b.__URL=document.location.host+b.__URL);Organics.__StringStartsWith(b.__URL,"ws://")?
b.__URL=b.__URL.slice(5):Organics.__StringStartsWith(b.__URL,"wss://")?b.__URL=b.__URL.slice(6):Organics.__StringStartsWith(b.__URL,"http://")?b.__URL=b.__URL.slice(7):Organics.__StringStartsWith(b.__URL,"https://")&&(b.__URL=b.__URL.slice(8));b.__HTTP_URL=b.TLS?"https://"+b.__URL:"http://"+b.__URL;b.__URL=Organics.WebSocketSupported?b.TLS?"wss://"+b.__URL:"ws://"+b.__URL:b.TLS?"https://"+b.__URL:"http://"+b.__URL;b.__logMessage=function(a){Organics.__Log("("+b.__URL+"): "+a)};b.__handleDisconnect=
function(a,c){if(!0==b.__connected||!0==b.__connecting){b.__connected=!1;b.__connecting=!1;b.__logMessage('-> Disconnected: "'+a+'"');var d=b.__handlers[Organics.Disconnect];d&&d(a)}b.__connected=!1;b.__connecting=!1};b.__handleConnect=function(){b.__logMessage("-> Connected");var a=b.__handlers[Organics.Connect];a&&a()}};this.Connection.prototype.Connected=function(){return!0==this.__connecting?!1:this.__connected};this.Connection.prototype.Close=function(){!0==this.__connected&&(this.__connected=
!1,Organics.WebSocketSupported&&this.__webSocket.close())};this.Connection.prototype.Connect=function(){var a=this;Organics.WebSocketSupported?a.__logMessage("WebSocket is supported"):a.__logMessage("No WebSocket support; using long polling");if(!a.__connected&&!a.__connecting){a.__logMessage("-> Connect()");a.__connecting=!0;var c=function(){Organics.WebSocketSupported?a.__connectWebSocket():Organics.__ajax(a.__HTTP_URL,"POST",{complete:function(c){a.__connectionId=c.responseText;a.__logMessage("-> Create session request successful: connected to server");
a.__connected=!0;a.__connecting=!1;setTimeout(function(){a.__doLongPolling()},0);a.__handleConnect()},error:function(c,b){a.__handleDisconnect("Create session request failed ("+b+")")}},null,a.Timeout,{"X-Organics-Req":Organics.__rtLongPollEstablishConnection})};Organics.__hasAlreadyLoaded?c():(Organics.__addEventListener(window,"load",c),Organics.__hasAlreadyLoaded=!0)}};this.Connection.prototype.__handleMessage=function(a){if(0<a.length){try{var c=JSON.parse(a)}catch(e){this.__handleDisconnect("Server sent bad JSON data: "+
e);Organics.webSocketSupported&&this.__webSocket.close();return}if(3==c.length){a=c[0];var b=c[1],c=c[2],f=null,k=this.__handlers[b];if(k){try{f=k.apply(void 0,c),null==f&&(f=[])}catch(d){Organics.__Log("Request handler exception:\n"+d);return}if(-1!==a)try{return JSON.stringify([a,f])}catch(h){Organics.__Log("Error encoding response:\n"+h)}}else Organics.__Log('Ignoring request "'+b+'", no handler.')}else if(2==c.length||1==c.length)if(a=c[0],c=1==c.length?[]:c[1],a=this.__requestHandlers[a])try{a.apply(void 0,
c)}catch(s){Organics.__Log("Request handler onComplete exception:\n"+s)}else Organics.__Log("Got invalid response; id is invalid; ignored.");else this.__handleDisconnect("Server sent bad JSON data: Must be array of length 3"),Organics.webSocketSupported&&this.__webSocket.close()}else if(Organics.WebSocketSupported)return""};this.Connection.prototype.__connectWebSocket=function(){var a=this;window.WebSocket?a.__webSocket=new WebSocket(a.__URL):window.MozWebSocket&&(a.__webSocket=new MozWebSocket(a.__URL));
a.__webSocket.onopen=function(c){a.__connected=!0;a.__connecting=!1;a.__handleConnect()};a.__webSocket.onclose=function(c){a.__handleDisconnect("connection closed")};a.__webSocket.onmessage=function(c){c=a.__handleMessage(c.data);null!=c&&a.__webSocket.send(c)};a.__webSocket.onerror=function(c){a.__handleDisconnect("disconnected"+c)}};this.Connection.prototype.__doLongPolling=function(){var a=this;Organics.__ajax(a.__HTTP_URL,"POST",{complete:function(c){c=a.__handleMessage(c.responseText);null!=
c&&Organics.__ajax(a.__HTTP_URL,"POST",{complete:function(a){},error:function(c,b){a.__handleDisconnect("POST request failed ("+b+")",0)}},c,null,{"X-Organics-Req":Organics.__rtMessage,"X-Organics-Conn":a.__connectionId});setTimeout(function(){a.__doLongPolling()},0)},error:function(c,e){a.__handleDisconnect("long-polling request failed ("+e+")",0)}},null,null,{"X-Organics-Req":Organics.__rtLongPoll,"X-Organics-Conn":a.__connectionId})};this.Connection.prototype.Request=function(){var a=this,c=Array.prototype.slice.call(arguments);
if(0!=c.length){var e=c[0];if(1<c.length){var b=c[c.length-1];"function"!=typeof b&&(b=null)}else b=null;c=null!=b?c.slice(1,c.length-1):c.slice(1,c.length);if(!a.Connected())throw a.__logMessage("-> Ignoring Request() call (Not connected)"),Organics.ErrNotConnected;a.__requestCounter++;-1==a.__requestCounter&&a.__requestCounter++;var f=a.__requestCounter;b?a.__requestHandlers[a.__requestCounter]=b:f=-1;e=JSON.stringify([f,e,c]);Organics.WebSocketSupported?a.__webSocket.send(e):Organics.__ajax(a.__HTTP_URL,
"POST",{complete:function(a){},error:function(b,c){b&&413==b.status?a.__handleDisconnect("JSON request data exceeded server's MaxBufferSize property.",0):a.__handleDisconnect("Request failed: "+c)}},e,a.Timeout,{"X-Organics-Req":Organics.__rtMessage,"X-Organics-Conn":a.__connectionId})}};this.Connection.prototype.Handle=function(a,c){if(null===c)delete this.__handlers[a];else{if("function"!==typeof c)throw TypeError('Handle() parameter "handler" must be function!');this.__handlers[a]=c}}};